# 進捗まとめ

## 2025-11-17
- Step1: 神父NPCとセーブ/ロード（localStorage）、タイトル画面の「続きから」を追加。
- 戦闘敗北時のペナルティ（Gold/Food半減・HP全快で復活）を実装。
- オーバーレイの基礎整備と宝箱開封メッセージの導入。

## 2025-11-20
- Step2: 装備/経済のバランス調整。木/銅/鉄/聖の武器・盾、Power Hammer・Holy Ore を追加し、価格と効果を調整。
- ショップの販売リストとステータス表示を更新。
- 戦闘後に50%でFood+10ドロップ、レベルアップ曲線と最大LV99を導入。
- 敵の出現数・リスポーン間隔の調整。

## 2025-11-21
- Step3: 鍛冶屋救出イベントの骨組み（B2の護衛、ストーリーフラグ保存、フェーズ別セリフ）を追加。
- Power Hammer授与、聖剣/聖盾イベントのフックを`game_state.js`/`dialogue.js`に実装。
- 旧・遺跡キー依存のフラグを整理し、宝箱管理やガーディアン処理を整備。

## 2025-11-22
- マップ拡張: `map_data.js`でCAVE2/CAVE2_B2/RUINS/RUINS_B2を接続。力のハンマーで岩を破壊するゲート、聖剣+聖盾で遺跡入場、聖鉱石宝箱を追加。洞窟2入口・遺跡階段・フィールド戻り座標を設計に合わせて調整。
- 敵拡張: 13種＋ドラゴンのパラメータとスプライトインデックスを追加。シーン別出現プールをデザインどおりに更新し、鍛冶屋護衛をウルフ×2に変更。
- 戦闘/エンディング: 聖剣なしでドラゴンにダメージ不可、聖盾なしで炎ダメージ増。ドラゴン撃破でエンディングオーバーレイを表示し、キー入力でタイトルに戻る。
- オーバーレイ復旧: 文字化けや構文崩れを修正し、タイトル画面/各オーバーレイを正常表示。`constants.js`にOVERLAY.ENDINGを追加。
- セーブ: ストレージキーをv2に更新（旧セーブは無効化）。
